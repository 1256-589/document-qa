/* ==========================================================================
   Streamlit åº”ç”¨è‡ªå®šä¹‰æ ·å¼ (å·²æ•´åˆä¼˜åŒ–)
   ========================================================================== */
@media (max-width: 576px) {
            .mobile-horizontal-grid [data-testid="stHorizontalBlock"] > div {
                /* 1. å°†åˆ—å®¹å™¨çš„æ˜¾ç¤ºæ¨¡å¼å¼ºåˆ¶æ”¹ä¸º grid */
                display: grid !important;
                /* 2. å®šä¹‰ä¸¤åˆ—ï¼Œæ¯åˆ—å æ®ç›¸ç­‰çš„ç©ºé—´ (1fr) */
                grid-template-columns: 1fr 1fr !important;
                /* 3. è®¾ç½®åˆ—ä¹‹é—´çš„é—´è· */
                gap: 1rem !important;
            }
        }

/* --- 1. å…¨å±€å­—ä½“å’ŒåŸºç¡€æ ·å¼ --- */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* éšè— Streamlit é»˜è®¤çš„é¡µçœ‰ã€é¡µè„šå’Œä¸»èœå•æŒ‰é’® */
#MainMenu, footer, header {
    /*visibility: hidden;*/
}


/* ==========================================================================
   2. ä¾§è¾¹æ  (Sidebar) æ ·å¼
   ========================================================================== */

/* --- 2.1 ä¾§è¾¹æ å®¹å™¨ --- */
[data-testid="stSidebar"] {
    background-color: #f8f9fa;
    border-right: 1px solid #e9ecef;
    padding: 2rem 0 0 0;
}

/* å‡å°ä¾§è¾¹æ å†…å…ƒç´ çš„å‚ç›´é—´è·ï¼Œä½¿å…¶æ›´ç´§å‡‘ */
[data-testid="stSidebar"] [data-testid="stVerticalBlock"] {
    gap: 0.3rem !important; /* ä½¿ç”¨ !important å¼ºåˆ¶è¦†ç›–é»˜è®¤å€¼ */
}

/* --- 2.2 ä¾§è¾¹æ æ ‡é¢˜ --- */
[data-testid="stSidebar"] h1 {
    /*position: sticky;*/
    top: 0;
    /*z-index: 100;*/
    font-size: 0rem;
    font-weight: 700;
    color: #1157c1; /* ä¸»é¢˜è‰² */
    text-align: center;
    padding-top: 1rem;
    padding-bottom: 1rem;
}

/* --- 2.3 å¯¹è¯å†å²/å¯¼èˆªæŒ‰é’® --- */
/* åŸºç¡€æ ·å¼ */
[data-testid="stSidebar"] .stButton > button {
    display: flex;
    align-items: center; /* ç¡®ä¿å›¾æ ‡å’Œæ–‡å­—å‚ç›´å±…ä¸­ */
    justify-content: center;
    gap: 0.5rem; /* å›¾æ ‡ä¸æ–‡å­—é—´è· */
    width: 100%;
    text-align: left;
    font-weight: 500;
    font-size: 0.9rem;
    color: #343a40;
    background-color: transparent; /* é»˜è®¤é€æ˜ */
    border: 1px solid transparent; /* é»˜è®¤é€æ˜è¾¹æ¡†ï¼Œæ–¹ä¾¿æ‚¬åœæ—¶å˜åŒ– */
    border-radius: 0.5rem;
    padding: 0.7rem 0.8rem;
    transition: all 0.2s ease-in-out;
}

/* æ‚¬åœæ•ˆæœ (é€‚ç”¨äºâ€œæ–°å»ºå¯¹è¯â€å’Œéæ¿€æ´»çš„å¯¹è¯å†å²) */
[data-testid="stSidebar"] .stButton > button:hover {
    background-color: #e9ecef; /* æ‚¬åœæ—¶æ˜¾ç¤ºæµ…ç°è‰²èƒŒæ™¯ */
    color: #1f2937;
    border-color: #d4d4d8;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

/* å½“å‰æ¿€æ´»å¯¹è¯çš„æ ·å¼ (ä½¿ç”¨ :has è‡ªåŠ¨è¯†åˆ«) */
[data-testid="stSidebar"] .stButton > button:has(strong) {
    background-color: #f0fdf4; /* æ¿€æ´»èƒŒæ™¯: æ·¡ç»¿è‰² */
    color: #166534;           /* æ¿€æ´»æ–‡å­—: æ·±ç»¿è‰² */
    font-weight: 600;
    border-color: transparent;
}
/* æ¿€æ´»çŠ¶æ€ä¸‹æ‚¬åœæ—¶ï¼Œä¿æŒæ¿€æ´»æ ·å¼ä¸å˜ */
[data-testid="stSidebar"] .stButton > button:has(strong):hover {
    background-color: #f0fdf4;
    color: #166534;
    transform: none;
    box-shadow: none;
}


/* --- 2.4 ä¸»è¦æ“ä½œæŒ‰é’® (å¦‚ "å¼€å§‹å¤„ç†") --- */
/* åŸºç¡€æ ·å¼ */
[data-testid="stSidebar"] button[data-testid="stBaseButton-primary"] {
    background-color: #138b40 !important; /* ä¸»é¢˜è‰²: ç»¿è‰² */
    color: white !important;
    border-color: #16a34a !important;
}
/* æ‚¬åœæ•ˆæœ */
[data-testid="stSidebar"] button[data-testid="stBaseButton-primary"]:hover {
    background-color: #15803d !important; /* æ‚¬åœ: æ·±ç»¿è‰² */
    border-color: #15803d !important;
}
/* ç¦ç”¨çŠ¶æ€ */
[data-testid="stSidebar"] button[data-testid="stBaseButton-primary"]:disabled {
    background-color: #e5e7eb !important; /* ç¦ç”¨èƒŒæ™¯: å†·ç°è‰² */
    color: #9ca3af !important;           /* ç¦ç”¨æ–‡å­—: ç°è‰² */
    border-color: #e5e7eb !important;
    cursor: not-allowed;
}

/* --- 2.5 ç‰¹æ®ŠæŒ‰é’® (å¦‚ "æ¸…ç©ºæ•°æ®" ) --- */
/* æ³¨æ„: ä¸‹æ–¹çš„ class åç§°å¯èƒ½éš Streamlit ç‰ˆæœ¬æ›´æ–°è€Œæ”¹å˜ï¼Œéœ€è°¨æ…ä½¿ç”¨ */
[data-testid="stSidebar"] .stButton > button.st-emotion-cache-19n915n {
    background-color: #d62728; /* å±é™©æ“ä½œçº¢è‰² */
    color: white;
    border: none;
}
[data-testid="stSidebar"] .stButton > button.st-emotion-cache-19n915n:hover {
    background-color: #c02223;
    color: white;
}


/* --- 2.6 â€œæ¨¡å‹åˆ‡æ¢â€å¼€å…³ (ä½¿ç”¨ Checkbox æ¨¡æ‹Ÿ) --- */
/* å®¹å™¨ */
/*label[data-baseweb="checkbox"] {*/
/*    display: flex;*/
/*    align-items: center;*/
/*    margin: auto;*/
/*    width: 100%;*/
/*    background-color: #f4f4f5;*/
/*    border: 1px solid #e4e4e7;*/
/*    border-radius: 0.5rem;*/
/*    padding: 0.6rem 0.8rem;*/
/*    margin-top: 0.5rem;*/
/*    cursor: pointer;*/
/*}*/
/* å¼€å…³è½¨é“ (å…³é—­æ—¶) */
label[data-baseweb="checkbox"] > div:first-of-type {
    background-color: #b2c2da !important;
}
/* å¼€å…³åœ†å½¢æ»‘å— */
label[data-baseweb="checkbox"] > div:first-of-type > div {
    background-color: #ffffff !important;
}
/* å¼€å…³å¼€å¯æ—¶çš„è½¨é“é¢œè‰² */
label[data-baseweb="checkbox"]:has(input[aria-checked="true"]) > div:first-of-type {
    background-color: #1157c1 !important; /* ä¸»é¢˜è“è‰² */
}

/* --- 2.7 åˆ†éš”çº¿ --- */
[data-testid="stSidebar"] hr {
    margin: 1.5rem 0;
}


/* ==========================================================================
   3. ä¸»å†…å®¹åŒº (Main Content) æ ·å¼
   ========================================================================== */

/* --- 3.1 èŠå¤©æ¶ˆæ¯ --- */
/* æ¶ˆæ¯å®¹å™¨åŸºç¡€æ ·å¼ */
.stChatMessage {
    border-radius: 0.95rem;
    border: 2px solid transparent;
    padding: 1rem 1.25rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    display: flex;
    align-items: flex-start; /* æ ¸å¿ƒï¼šå¤´åƒä¸å†…å®¹é¡¶éƒ¨å¯¹é½ */
    gap: 1.1rem;             /* å¤´åƒä¸æ°”æ³¡çš„é—´è· */
}
/* ç”¨æˆ·æ¶ˆæ¯æ ·å¼ */
[data-testid="stLayoutWrapper"] {
    background-color: #fffdfd;
    border: 1px solid #b1b4b6; /* ç”¨æˆ·ä¸»é¢˜è‰² */
    box-shadow: 3px 3px 3px 3px rgba(0, 0, 0, 0.05);
    border-radius: 1rem;
}
 /*AI æ¶ˆæ¯æ ·å¼ */
/*[data-testid="stChatMessage"]:has(span[data-testid="chat-avatar-ai"]) {*/
/*    background-color: #ffffff;*/
/*    border-left: 5px solid #ff7f0e; !* AI ä¸»é¢˜è‰² *!*/
/*}*/
/* ç§»é™¤æ¶ˆæ¯å†…å®¹å—å†…ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸Šè¾¹è·ï¼Œä½¿å…¶ç´§é é¡¶éƒ¨ */
[data-testid="stChatMessageContent"] div[data-testid="stVerticalBlock"] > div:first-child {
    margin-top: 0;
}


/* --- 3.2 æç®€ç´§å‡‘ç‰ˆæ–‡ä»¶ä¸Šä¼ å™¨ --- */
[data-testid='stFileUploader'] {
    width: 100%;
    margin-bottom: 0.5rem ;
    padding: 1rem;
    border: 2px dashed #e0e0e0;
    background-color: #ffffff;
    border-radius: 0.5rem;
}
[data-testid='stFileUploader']:hover {
    border-color: #1f77b4; /* ä¸»é¢˜è‰² */
}
/* éšè—é»˜è®¤æ ‡ç­¾ */
[data-testid='stFileUploader'] > label {
    display: none;
}
/* æ‹–æ‹½åŒºåŸŸ */
[data-testid='stFileUploaderDropzone'] {
    border: none;
    border-radius: 6px;
    padding: 12px;
    text-align: center;
    background-color: #fafafa;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
}
/* éšè—æ‰€æœ‰é»˜è®¤çš„æŒ‡ç¤ºæ–‡å­— */
[data-testid='stFileUploaderDropzoneInstructions'] > div > span,
[data-testid='stFileUploaderDropzoneInstructions'] > div > small {
    display: none !important;
}
/* ä½¿ç”¨ ::before ä¼ªå…ƒç´ åˆ›å»ºè‡ªå®šä¹‰ä¸Šä¼ æç¤º */
[data-testid='stFileUploaderDropzoneInstructions'] > div::before {
    content: 'ğŸ“ æ–‡ä»¶ä¸Šä¼ ';
    font-size: 17px;
    color: #666;
    display: block;
    margin: 0;
    padding: 0;
}
/* æ–‡ä»¶åå’Œåˆ é™¤æŒ‰é’® */
[data-testid='stFileUploaderFileName'] {
    font-size: 12px;
    margin: 5px 0;
}
[data-testid='stFileUploaderDeleteBtn'] {
    font-size: 12px;
    padding: 2px 6px;
    margin-left: 8px;
}
/* éšè—é»˜è®¤çš„ "Browse files" æŒ‰é’®ï¼Œåªä¿ç•™æ‹–æ‹½åŠŸèƒ½å’Œè‡ªå®šä¹‰æç¤º */
[data-testid='stBaseButton-secondary'] {
    display: none;
}


/* --- 3.3 æŠ˜å é¢æ¿ (Expander, ç”¨äºçŸ¥è¯†åº“æ–‡ä»¶å±•ç¤º) --- */
/* å®¹å™¨ */
[data-testid="stExpander"] {
    border: 1px  #e9ecef;
    border-radius: 0.6rem;
    background-color: #ffffff;
    /*margin-top: 0.5rem;*/
    transition: box-shadow 0.2s ease-in-out;
}
[data-testid="stExpander"]:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}
/* æ ‡é¢˜æ  */
[data-testid="stExpander"] summary {
    font-size: 1rem;
    font-weight: 500;
    color: #343a40;
    padding: 0.8rem 1rem;
}
/* æ ‡é¢˜æ çš„ä¸‹æ‹‰ç®­å¤´å›¾æ ‡ */
[data-testid="stExpander"] summary svg {
    color: #343a40;
}
/* å±•å¼€åçš„å†…å®¹åŒºåŸŸ */
[data-testid="stExpanderDetails"] {
    padding: 0 0.8rem 0.8rem 0.8rem;
}
/* å†…éƒ¨çš„æç¤ºæ–‡å­— (e.g., "å½“å‰åº“ä¸­æœ‰...") */
[data-testid="stExpanderDetails"] [data-testid="stCaption"] {
    text-align: center;
    padding-bottom: 0.8rem;
    border-bottom: 1px dashed #e9ecef;
    margin-bottom: 0.6rem;
    color: #6c757d;
    font-size: 0.8rem;
    font-weight: 400;
}
/* æ–‡ä»¶åˆ—è¡¨çš„ Markdown é¡¹ï¼Œå‡å°‘é—´è· */
[data-testid="stExpanderDetails"] [data-testid="stMarkdown"] {
    margin-bottom: -12px;
}
/* æ–‡ä»¶åˆ—è¡¨æ¯ä¸€é¡¹çš„æ ·å¼ */
[data-testid="stExpanderDetails"] [data-testid="stMarkdown"] p {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.6rem;
    border-radius: 0.4rem;
    transition: background-color 0.2s ease;
    font-size: 1rem;
    font-weight: 400;
    color: #374151;
}
[data-testid="stExpanderDetails"] [data-testid="stMarkdown"] p:hover {
    background-color: #f8f9fa;
}


/* --- 3.4 AI æ¶ˆæ¯å†… Markdown å†…å®¹çš„ç¾åŒ– --- */
/* æ ‡é¢˜ (H1-H6) */
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h1,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h2,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h3,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h4,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h5,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h6 {
    margin-block-start: 1.2em;
    margin-block-end: 0.6em;
    font-weight: 600;
    color: #1f2937;
    border-bottom: none !important;
    padding-bottom: 0;
    /*padding-right: 5px;*/
}
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h1 { font-size: 1.45rem; }
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h2 { font-size: 1.25rem; }
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h3 { font-size: 1.15rem; }
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h4,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h5,
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] h6 { font-size: 1rem; }

/* å¤§æ®µä»£ç å— (<pre><code>) */
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] pre {
    background-color: #f3f4f6;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-right: 0.5rem;
    line-height: 1.5;
}
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] pre code {
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
    color: #111827;
    font-size: 0.975rem;
    /*margin-right: 5rem;*/
}

/* è¡Œå†…ä»£ç  (<code>) */
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] :not(pre) > code {
    background-color: #f3f4f6;
    color: #0a2537;
    padding: 0.15em 0.4em;
    border-radius: 0.25rem;
    font-size: 1.0em;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

/* ä»£ç å—çš„å¤åˆ¶æŒ‰é’® */
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] pre button {
    background-color: #d3d4d6 !important;
    border: 1px solid #d1d5db !important;
    border-radius: 0.375rem !important;
    transition: background-color 0.2s ease !important;
}
[data-testid="stChatMessageContent"][aria-label="Chat message from ai"] pre button:hover {
    background-color: #d1d5db !important;
}

/* Hide the sidebar collapse button */
[data-testid="stSidebarHeader"] {
    display: none;
}

[role="dialog"]:has(.custom-wide-dialog) {
        max-width: 85vw !important; /* å°†å¼¹çª—æœ€å¤§å®½åº¦è®¾ä¸ºè§†å£çš„85% */
    }

    /* è§„åˆ™ 2: å¼ºåˆ¶è®©è¯¥å¼¹çª—å†…çš„stDataFrameç»„ä»¶å®½åº¦å æ»¡100% */
[role="dialog"]:has(.custom-wide-dialog) [data-testid="stDataFrame"] {
        width: 100% !important;
        max-width: none !important; /* å…³é”®ï¼šè¦†ç›–æ‰é»˜è®¤çš„æœ€å¤§å®½åº¦é™åˆ¶ */
    }
